USE [vitalchoice2.0]
GO

/****** Object:  UserDefinedFunction [dbo].[RegexReplace]    Script Date: 7/23/2016 7:15:25 PM ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO

DROP FUNCTION [dbo].[RegexReplace]
DROP FUNCTION [dbo].[IsMatch]
DROP FUNCTION [dbo].[ClearRegexCache]
DROP ASSEMBLY [DBRegexSupport]

GO

CREATE ASSEMBLY [DBRegexSupport]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300C59693570000000000000000E00022200B013000000E000000060000000000003A2C0000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000E82B00004F00000000400000A803000000000000000000000000000000000000006000000C000000B02A00001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000400C000000200000000E000000020000000000000000000000000000200000602E72737263000000A8030000004000000004000000100000000000000000000000000000400000402E72656C6F6300000C00000000600000000200000014000000000000000000000000000040000042000000000000000000000000000000001C2C0000000000004800000002000500682200004808000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300400B2000000010000110F00280F00000A2D090F01280F00000A2C067E1000000A2AFE137E010000040F00281100000A12006F1200000A2D6AFE137E010000040B07281300000AFE137E010000040F00281100000A12006F1200000A2D3C0F00FE16150000016F1400000A1F19731500000A0AFE137E01000004731600000A250F00FE16150000016F1400000A066F1700000AFE138001000004DE0707281800000ADC060F01FE16150000016F1400000A6F1900000A281A00000A2A00000110000002003D0055920007000000001B3002003A00000002000011FE137E010000040A06281300000AFE137E010000046F1B00000A16FE02FE137E010000046F1C00000A281A00000A0BDE0706281800000ADC072A00000110000002000E0023310007000000001B300400C4000000010000110F00280F00000A2D120F01280F00000A2D090F02280F00000A2C02032AFE137E010000040F00281100000A12006F1200000A2D6AFE137E010000040B07281300000AFE137E010000040F00281100000A12006F1200000A2D3C0F00FE16150000016F1400000A1F19731500000A0AFE137E01000004731600000A250F00FE16150000016F1400000A066F1700000AFE138001000004DE0707281800000ADC060F01FE16150000016F1400000A0F02FE16150000016F1400000A6F1D00000A281E00000A2A0110000002004200559700070000000036731F00000AFE1380010000042A000042534A4201000100000000000C00000076322E302E35303732370000000005006C000000D0020000237E00003C0300009C03000023537472696E677300000000D80600000400000023555300DC060000100000002347554944000000EC0600005C01000023426C6F620000000000000002000001571502080900000000FA0133001600000100000018000000020000000100000004000000050000001F000000100000000200000001000000010000000300000000001F0201000000000006005201CF020600BF01CF0206008A009D020F00EF0200000600B2004F02060035014F02060001014F020600A6014F02060072014F0206008B014F020600C9004F0206009E00B00206007C00B0020600E4004F0206003F033D0206006B00CF02060002002D000A00820313030E0020016D020E004402FE020E000402FE0206009502F3010A0032031303060001002D00000000000F000000000001000100810110008E0300003D000100010011005F009300502000000000960017029E00010020210000000096005400A700030078210000000096004C00AC00030058220000000091188E02B7000600000001008803000002007C03000001008803000002007C03000003005703090088020100110088020600190088020A00290088021000310088021000390088021000410088021000490088021000510088021000590088021000610088021500690088021000710088021000990088020600A90032022600A10076002A00A900DD012E000C00E7013A00B1006702430079000E022E009100880248000C0088024F000C0048005B00B10052034300910017026300A100460368000C0063037A000C006102060091004C007E00A900460384000C00880206002000730055012E000B00BB002E001300C4002E001B00E3002E002300EC002E002B0000012E00330000012E003B0000012E004300EC002E004B0006012E00530000012E005B0000012E0063001E012E006B0048014000730055016000730055011A006E0032000480000001000000000000000000000000006D0300000200000000000000000000008A002400000000000200000000000000000000008A003D02000000000200000000000000000000008A0018000000000000000000004944696374696F6E6172796032003C4D6F64756C653E0053797374656D2E44617461006D73636F726C69620053797374656D2E436F6C6C656374696F6E732E47656E6572696300416464005265706C61636500436C6561724361636865005F72656765784361636865004973566F6C6174696C650046616C736500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C75650054727947657456616C75650053797374656D2E546872656164696E670053716C537472696E6700546F537472696E670049734D617463680044425265676578537570706F72742E646C6C006765745F49734E756C6C0053797374656D0053716C426F6F6C65616E0053797374656D2E5265666C656374696F6E00436C65617200456E746572004D6963726F736F66742E53716C5365727665722E536572766572002E63746F72002E6363746F72004D6F6E69746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730053797374656D2E446174612E53716C54797065730053797374656D2E546578742E526567756C617245787072657373696F6E730052656765784F7074696F6E73004F626A656374006F705F496D706C696369740045786974007265706C6163656D656E74006765745F436F756E740044425265676578537570706F727400696E7075740052656765780072656765780052656765784C6962726172790000000000000AC35F0DFAB768469745BC38D0B585C100042001010803200001052001011111042001010E04200101020B07021249151245020E124903200002030611510320000E07151245020E1249082002021300101301040001011C062002010E115D0B20010115126102130013010720020113001301042001020E0500011151020B0702151245020E12491151032000080520020E0E0E05000111550E08B77A5C561934E0890A061F41151245020E124908000211511155115504000011510A00031155115511551155030000010801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000001301000E44425265676578537570706F7274000005010000000017010012436F7079726967687420C2A920203230313500002901002466303066303466362D303234632D346635322D393261372D37633031626464346337646600000C010007312E302E302E3000000401000000000000000000C596935700000000020000001C010000CC2A0000CC0C000052534453853F37376031F942937C1FC0E503216201000000443A5C576F726B5C566974616C2D43686F6963652D43532D506F7274616C5C7372635C44425265676578537570706F72745C6F626A5C52656C656173655C44425265676578537570706F72742E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000102C000000000000000000002A2C00000020000000000000000000000000000000000000000000001C2C0000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000004C03000000000000000000004C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004AC020000010053007400720069006E006700460069006C00650049006E0066006F0000008802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E007400730000000000000022000100010043006F006D00700061006E0079004E0061006D006500000000000000000046000F000100460069006C0065004400650073006300720069007000740069006F006E0000000000440042005200650067006500780053007500700070006F007200740000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000046001300010049006E007400650072006E0061006C004E0061006D0065000000440042005200650067006500780053007500700070006F00720074002E0064006C006C00000000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100350000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000004E00130001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000440042005200650067006500780053007500700070006F00720074002E0064006C006C00000000003E000F000100500072006F0064007500630074004E0061006D00650000000000440042005200650067006500780053007500700070006F007200740000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C0000003C3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = UNSAFE

GO

CREATE FUNCTION [dbo].[RegexReplace](@expression [nvarchar](250), @string [nvarchar](max), @replacement [nvarchar](max))
RETURNS [nvarchar](max) WITH EXECUTE AS CALLER
AS 
EXTERNAL NAME [DBRegexSupport].[RegexLibrary].[Replace]
GO


CREATE FUNCTION [dbo].[IsMatch](@expression [nvarchar](250), @string [nvarchar](max))
RETURNS [bit] WITH EXECUTE AS CALLER
AS 
EXTERNAL NAME [DBRegexSupport].[RegexLibrary].[IsMatch]
GO


CREATE FUNCTION [dbo].[ClearRegexCache]()
RETURNS [bit] WITH EXECUTE AS CALLER
AS 
EXTERNAL NAME [DBRegexSupport].[RegexLibrary].[ClearCache]
GO


