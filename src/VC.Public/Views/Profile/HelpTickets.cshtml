@using System.Globalization;
@using System.Collections.Generic;
@using VitalChoice.Interfaces.Services
@using VitalChoice.Infrastructure.Domain.Transfer
@model  ICollection<VitalChoice.SharedWeb.Models.Help.HelpTicketListItemModel>
@inject ReferenceData appInfrastructureService;

@section Meta {
    <title>Vital Choice | Help Tickets</title>
}

@{
    var infrastructure = appInfrastructureService;
}

<div class="working-area-holder">
    <div class="left-pane clean-border">
        @await Component.InvokeAsync("ProfileSidebar")
    </div>
    <div class="right-pane clean-indent paid-orders">
        <div class="border-form-left">
            @if (ViewBag.IdOrder > 0)
            {
                <h4>Help Desk</h4>
                <div class="form-group">
                    <span>Order #: <span class="info-text">@ViewBag.IdOrder</span></span><br />
                    <strong>Welcome to our Customer Service Desk.</strong><br /><br />
                    @Html.ActionLink("Create a Help Ticket", "HelpTicket", new { idorder = ViewBag.IdOrder }, new { @class = "button yellow pull-right" })
                    <span>Use this section of our store to exchange order-related messages with us.</span><br />
                    <span>Here is a summary of the messages exchanged with regard to this order:</span>
                </div>
                <table class="standard-table">
                    <thead>
                        <tr>
                            <th>
                                Summary
                            </th>
                            <th>
                                Date Submitted
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Count > 0)
                        {
                            foreach (var item in Model)
                            {
                                <tr>
                                    <td>
                                        @Html.ActionLink(item.Summary, "HelpTicket", "Profile", new { id = item.Id })
                                    </td>
                                    <td>
                                        @item.DateCreated.ConvertToPst().ToString("MM/dd/yyyy hh:mm tt", System.Globalization.CultureInfo.InvariantCulture)
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>
</div>